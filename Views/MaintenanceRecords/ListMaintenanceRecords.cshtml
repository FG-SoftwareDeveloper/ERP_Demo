@{
    Layout = "_Layout";
    // Example data for static design; replace with your model in production
    var records = new[] {
        new { RecordID = 1, Equipment = "Excavator", Type = "Scheduled", Status = "Completed", Date = DateTime.Parse("2025-08-10"), Technician = "Alice Smith", Cost = 1200m, AIInsights = "No issues detected. Next service in 6 months." },
        new { RecordID = 2, Equipment = "Forklift", Type = "Unscheduled", Status = "In Progress", Date = DateTime.Parse("2025-08-20"), Technician = "John Doe", Cost = 800m, AIInsights = "Part replacement required. Delay expected." },
        new { RecordID = 3, Equipment = "Generator", Type = "Scheduled", Status = "Pending", Date = DateTime.Parse("2025-09-01"), Technician = "Maria Garcia", Cost = 500m, AIInsights = "Low usage. Service can be postponed." }
    };
}

<div class="container-fluid py-4">
    <!-- Header: Predictive Maintenance -->
    <div class="row g-4 mb-4">
        <div class="col-12">
            <div class="card glass-effect border-0 animate-fade-in-up">
                <div class="card-body p-4 d-flex flex-column flex-md-row align-items-md-center justify-content-between">
                    <div>
                        <h1 class="mb-1 text-themed-primary d-flex align-items-center">
                            <i class="bi bi-wrench-adjustable-circle me-3 icon-primary fs-2"></i> Maintenance Records
                        </h1>
                        <p class="text-themed-secondary mb-0">Predict failures, schedule work, and prove compliance with one click.</p>
                    </div>
                    <div class="mt-3 mt-md-0 d-flex flex-wrap gap-2">
                        <button class="btn btn-themed" data-bs-toggle="modal" data-bs-target="#newWO"><i class="bi bi-plus-circle me-2"></i>Log Work Order</button>
                        <button class="btn btn-themed-secondary" data-bs-toggle="offcanvas" data-bs-target="#plannerPanel"><i class="bi bi-calendar2-week me-2"></i>Planner</button>
                        <button class="btn btn-outline-secondary focus-ring" data-bs-toggle="modal" data-bs-target="#aiTroubleshoot"><i class="bi bi-robot me-2"></i>Troubleshoot</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Signature: Health grid + compliance dial + upcoming schedule -->
    <div class="row g-4 mb-4">
        <div class="col-xxl-6">
            <div class="card glass-effect border-0 h-100">
                <div class="card-header bg-transparent border-0 p-4"><h5 class="mb-0 text-themed-primary"><i class="bi bi-heart-pulse me-2 icon-warning"></i>Asset Health (AI Probability)</h5></div>
                <div class="card-body p-4">
                    <div class="row g-3">
                        <!-- R/Y/G health tiles -->
                        <div class="col-6 col-lg-4">
                            <div class="card hover-3d kpi-card border-0">
                                <div class="card-body">
                                    <div class="small text-themed-secondary">Pump #4</div>
                                    <div class="display-6 text-danger fw-bold">72%</div>
                                    <small class="text-themed-secondary">Fail chance in 3 wks</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-6 col-lg-4">
                            <div class="card hover-3d kpi-card border-0">
                                <div class="card-body">
                                    <div class="small text-themed-secondary">Compressor #2</div>
                                    <div class="display-6 text-warning fw-bold">41%</div>
                                    <small class="text-themed-secondary">Monitor vibration</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-6 col-lg-4">
                            <div class="card hover-3d kpi-card border-0">
                                <div class="card-body">
                                    <div class="small text-themed-secondary">Boiler A</div>
                                    <div class="display-6 text-success fw-bold">11%</div>
                                    <small class="text-themed-secondary">Healthy</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="mt-4 chart-container"><canvas id="maintAnomalyChart"></canvas></div>
                </div>
            </div>
        </div>

        <div class="col-xxl-3">
            <div class="card glass-effect border-0 h-100">
                <div class="card-header bg-transparent border-0 p-4"><h5 class="mb-0 text-themed-primary"><i class="bi bi-shield-check me-2 icon-success"></i>Compliance Dial</h5></div>
                <div class="card-body p-4">
                    <div class="chart-container mb-3"><canvas id="complianceGauge"></canvas></div>
                    <div class="d-flex justify-content-between small text-themed-secondary">
                        <span>Inspections on time</span><span class="fw-semibold text-themed-primary">94%</span>
                    </div>
                    <div class="mt-3 d-grid">
                        <button class="btn btn-themed-secondary btn-sm"><i class="bi bi-file-earmark-text me-1"></i>Generate OSHA/ISO Pack</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-xxl-3">
            <div class="card glass-effect border-0 h-100">
                <div class="card-header bg-transparent border-0 p-4"><h5 class="mb-0 text-themed-primary"><i class="bi bi-calendar2-week me-2 icon-info"></i>Upcoming Schedule</h5></div>
                <div class="card-body p-0">
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item bg-transparent d-flex justify-content-between">
                            <span>Pump #4 – Bearing swap</span><span class="badge bg-warning text-warning badge-themed">3 days</span>
                        </li>
                        <li class="list-group-item bg-transparent d-flex justify-content-between">
                            <span>Compressor #2 – Oil change</span><span class="badge bg-info text-info badge-themed">1 wk</span>
                        </li>
                        <li class="list-group-item bg-transparent d-flex justify-content-between">
                            <span>Boiler A – Annual test</span><span class="badge bg-success text-success badge-themed">2 wks</span>
                        </li>
                    </ul>
                    <div class="p-3">
                        <button class="btn btn-outline-secondary focus-ring w-100" data-bs-toggle="offcanvas" data-bs-target="#plannerPanel"><i class="bi bi-sliders me-1"></i>Optimize Schedule</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Work Orders Table with status swimlanes -->
    <div class="row">
        <div class="col-12">
            <div class="card themed-table border-0">
                <div class="card-header bg-transparent border-0 p-4 d-flex flex-column flex-md-row align-items-md-center justify-content-between">
                    <h5 class="mb-2 mb-md-0 text-themed-primary"><i class="bi bi-kanban me-2 icon-primary"></i>Open Work Orders</h5>
                    <div class="d-flex gap-2">
                        <div class="btn-group btn-group-sm">
                            <button class="btn btn-outline-primary focus-ring active">All</button>
                            <button class="btn btn-outline-primary focus-ring">Preventive</button>
                            <button class="btn btn-outline-primary focus-ring">Corrective</button>
                        </div>
                        <button class="btn btn-outline-secondary focus-ring" data-bs-toggle="modal" data-bs-target="#bulkAssign"><i class="bi bi-people me-1"></i>Bulk Assign</button>
                    </div>
                </div>
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table table-hover align-middle mb-0">
                            <thead>
                                <tr><th>WO #</th><th>Equipment</th><th>Type</th><th>Priority</th><th>Downtime</th><th>Cost</th><th>Owner</th><th>Status</th><th>Actions</th></tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>WO-10234</td>
                                    <td>Compressor #2</td>
                                    <td>Preventive</td>
                                    <td><span class="badge badge-themed bg-warning text-warning">High</span></td>
                                    <td>1.2h</td>
                                    <td>$320</td>
                                    <td>J. Lee</td>
                                    <td><span class="badge badge-themed bg-info text-info">In Progress</span></td>
                                    <td>
                                        <div class="btn-group">
                                            <button class="btn btn-sm btn-outline-primary" data-bs-toggle="modal" data-bs-target="#woDetail"><i class="bi bi-eye"></i></button>
                                            <button class="btn btn-sm btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#dispatch"><i class="bi bi-truck"></i></button>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td>WO-10235</td>
                                    <td>Pump #4</td>
                                    <td>Corrective</td>
                                    <td><span class="badge badge-themed bg-danger text-danger">Critical</span></td>
                                    <td>3.1h</td>
                                    <td>$780</td>
                                    <td>A. Singh</td>
                                    <td><span class="badge badge-themed bg-success text-success">Completed</span></td>
                                    <td><button class="btn btn-sm btn-outline-secondary"><i class="bi bi-receipt"></i></button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="card-footer bg-transparent border-0 p-4">
                    <small class="text-themed-secondary">Tip: AI will auto-suggest parts kits based on failure mode history.</small>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Offcanvas: Planner -->
<div class="offcanvas offcanvas-end" tabindex="-1" id="plannerPanel">
    <div class="offcanvas-header">
        <h5 class="offcanvas-title"><i class="bi bi-calendar-check me-2"></i>Smart Planner</h5>
        <button class="btn-close" data-bs-dismiss="offcanvas"></button>
    </div>
    <div class="offcanvas-body">
        <div class="chart-container mb-3"><canvas id="capacityChart"></canvas></div>
        <div class="mb-3">
            <label class="form-label">Downtime Weight</label>
            <input type="range" class="form-range" min="0" max="100" value="70">
        </div>
        <button class="btn btn-themed w-100"><i class="bi bi-magic me-2"></i>Optimize</button>
    </div>
</div>

<!-- Modals -->
<div class="modal fade" id="aiTroubleshoot" tabindex="-1">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content glass-effect border-0">
            <div class="modal-header"><h5 class="modal-title"><i class="bi bi-robot me-2"></i>AI Troubleshooter</h5><button class="btn-close" data-bs-dismiss="modal"></button></div>
            <div class="modal-body">
                <div class="alert alert-warning"><i class="bi bi-lightning me-2"></i>Pump #4 shows abnormal vibration spikes. Likely bearing wear. Recommend inspection + kit <strong>BR-6205</strong>.</div>
                <ul class="small text-themed-secondary mb-0">
                    <li>Check lubrication history last 60 days</li>
                    <li>Schedule thermography with load ? 70%</li>
                    <li>Pre-stage spare seals & couplings</li>
                </ul>
            </div>
            <div class="modal-footer"><button class="btn btn-themed-secondary"><i class="bi bi-tools me-1"></i>Create Work Package</button><button class="btn btn-outline-secondary" data-bs-dismiss="modal">Close</button></div>
        </div>
    </div>
</div>

<div class="modal fade" id="newWO" tabindex="-1">
    <div class="modal-dialog modal-md modal-dialog-centered">
        <div class="modal-content glass-effect border-0">
            <div class="modal-header"><h5 class="modal-title"><i class="bi bi-plus-lg me-2"></i>Log Work Order</h5><button class="btn-close" data-bs-dismiss="modal"></button></div>
            <div class="modal-body">
                <div class="mb-3"><label class="form-label">Equipment</label><input class="form-control focus-ring" placeholder="Search equipment..."></div>
                <div class="mb-3"><label class="form-label">Type</label><select class="form-select focus-ring"><option>Preventive</option><option>Corrective</option><option>Inspection</option></select></div>
                <div class="mb-3"><label class="form-label">Notes</label><textarea class="form-control focus-ring" rows="3"></textarea></div>
            </div>
            <div class="modal-footer"><button class="btn btn-themed"><i class="bi bi-check2 me-1"></i>Create</button></div>
        </div>
    </div>
</div>

<div class="modal fade" id="bulkAssign" tabindex="-1">
    <div class="modal-dialog modal-sm modal-dialog-centered">
        <div class="modal-content glass-effect border-0">
            <div class="modal-header"><h6 class="modal-title"><i class="bi bi-person-gear me-2"></i>Bulk Assign</h6><button class="btn-close" data-bs-dismiss="modal"></button></div>
            <div class="modal-body">
                <label class="form-label">Technician</label>
                <select class="form-select focus-ring"><option>J. Lee</option><option>A. Singh</option></select>
            </div>
            <div class="modal-footer"><button class="btn btn-themed">Assign</button></div>
        </div>
    </div>
</div>
