@{
    Layout = "_Layout";
    // Example data for static design; replace with your model in production
    var materials = new[] {
        new { MaterialID = 1, Name = "Concrete", Type = "Bulk", Status = "Available", Location = "Site A", Quantity = 120, Unit = "m³", LastUsed = DateTime.Parse("2025-08-28"), Cost = 4800m, AIInsights = "Usage trend stable. No shortages expected." },
        new { MaterialID = 2, Name = "Steel Rebar", Type = "Structural", Status = "Low Stock", Location = "Warehouse", Quantity = 15, Unit = "tons", LastUsed = DateTime.Parse("2025-08-25"), Cost = 9000m, AIInsights = "Low stock. Reorder recommended." },
        new { MaterialID = 3, Name = "Insulation", Type = "Finish", Status = "Ordered", Location = "Supplier", Quantity = 200, Unit = "sheets", LastUsed = DateTime.Parse("2025-08-20"), Cost = 3200m, AIInsights = "Delivery expected in 3 days." }
    };
}

<div class="container-fluid py-4">
    <!-- Header -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card glass-effect border-0">
                <div class="card-body p-4 d-flex flex-column flex-md-row align-items-md-center justify-content-between">
                    <div>
                        <h1 class="mb-1 text-themed-primary d-flex align-items-center">
                            <i class="bi bi-box-seam me-3 icon-primary fs-2"></i> Materials
                        </h1>
                        <p class="text-themed-secondary mb-0">ABC classification, multi-site heatmap, and supplier risk radar.</p>
                    </div>
                    <div class="mt-3 mt-md-0 d-flex flex-wrap gap-2">
                        <button class="btn btn-themed" data-bs-toggle="modal" data-bs-target="#newMaterial"><i class="bi bi-plus-circle me-2"></i>New Material</button>
                        <button class="btn btn-themed-secondary" data-bs-toggle="offcanvas" data-bs-target="#reorderPanel"><i class="bi bi-arrow-repeat me-2"></i>Reorder Assistant</button>
                        <button class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#aiOptimize"><i class="bi bi-robot me-2"></i>Optimize Stock</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Signature: Heatmap + ABC chips + Supplier Risk Radar -->
    <div class="row g-4 mb-4">
        <div class="col-xxl-7">
            <div class="card glass-effect border-0 h-100">
                <div class="card-header bg-transparent border-0 p-4 d-flex align-items-center justify-content-between">
                    <h5 class="mb-0 text-themed-primary"><i class="bi bi-grid-3x3-gap me-2 icon-info"></i>Stock Heatmap (Sites × SKUs)</h5>
                    <div class="btn-group btn-group-sm">
                        <button class="btn btn-outline-primary active">Qty</button>
                        <button class="btn btn-outline-primary">Value</button>
                        <button class="btn btn-outline-primary">Days Cover</button>
                    </div>
                </div>
                <div class="card-body p-4">
                    <div class="chart-container"><canvas id="materialsHeatmap"></canvas></div>
                </div>
            </div>
        </div>
        <div class="col-xxl-5">
            <div class="card glass-effect border-0 h-100">
                <div class="card-header bg-transparent border-0 p-4"><h5 class="mb-0 text-themed-primary"><i class="bi bi-bullseye me-2 icon-warning"></i>ABC Classification</h5></div>
                <div class="card-body p-4">
                    <div class="d-flex gap-2 flex-wrap mb-3">
                        <span class="badge rounded-pill bg-primary">A – 20%</span>
                        <span class="badge rounded-pill bg-info">B – 30%</span>
                        <span class="badge rounded-pill bg-secondary">C – 50%</span>
                    </div>
                    <div class="chart-container mb-3"><canvas id="abcPareto"></canvas></div>
                    <div class="chart-container"><canvas id="supplierRiskRadar"></canvas></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Table (distinct columns: multi-site) -->
    <div class="row">
        <div class="col-12">
            <div class="card themed-table border-0">
                <div class="card-header bg-transparent border-0 p-4 d-flex flex-column flex-md-row align-items-md-center justify-content-between">
                    <h5 class="mb-2 mb-md-0 text-themed-primary"><i class="bi bi-table me-2 icon-primary"></i>Materials Master</h5>
                    <div class="d-flex gap-2">
                        <input class="form-control focus-ring" placeholder="Search SKU, name, supplier" style="max-width: 260px;">
                        <button class="btn btn-outline-secondary focus-ring"><i class="bi bi-funnel"></i></button>
                    </div>
                </div>
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table table-hover align-middle mb-0">
                            <thead><tr><th>SKU</th><th>Name</th><th>Unit</th><th>WH A</th><th>Site B</th><th>Total</th><th>Reorder</th><th>Supplier</th><th>ABC</th><th>Actions</th></tr></thead>
                            <tbody>
                                <tr>
                                    <td>MAT-00123</td>
                                    <td>Steel Rod 10mm</td>
                                    <td>pcs</td>
                                    <td>1,000</td>
                                    <td>240</td>
                                    <td>1,240</td>
                                    <td>800</td>
                                    <td>Global Metals</td>
                                    <td>A</td>
                                    <td><button class="btn btn-sm btn-outline-secondary" data-bs-toggle="offcanvas" data-bs-target="#reorderPanel"><i class="bi bi-cart-plus"></i></button></td>
                                </tr>
                                <tr>
                                    <td>MAT-00456</td>
                                    <td>Box (L)</td>
                                    <td>pcs</td>
                                    <td>100</td>
                                    <td>20</td>
                                    <td>120</td>
                                    <td>300</td>
                                    <td>PackIt</td>
                                    <td>B</td>
                                    <td><button class="btn btn-sm btn-outline-primary"><i class="bi bi-eye"></i></button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="card-footer bg-transparent border-0 p-4"><small class="text-themed-secondary">AI: reorder simulation reduces carrying cost by <strong>12%</strong> with fill-rate ? 98%.</small></div>
            </div>
        </div>
    </div>
</div>

<!-- Offcanvas: Reorder Assistant -->
<div class="offcanvas offcanvas-end" tabindex="-1" id="reorderPanel">
    <div class="offcanvas-header"><h5 class="offcanvas-title"><i class="bi bi-arrow-repeat me-2"></i>Reorder Assistant</h5><button class="btn-close" data-bs-dismiss="offcanvas"></button></div>
    <div class="offcanvas-body">
        <div class="mb-3"><label class="form-label">Service Level Target</label><input type="range" class="form-range" min="90" max="99" value="98"></div>
        <div class="mb-3"><label class="form-label">Lead Time (days)</label><input class="form-control focus-ring" value="14"></div>
        <div class="chart-container mb-3"><canvas id="reorderCurve"></canvas></div>
        <button class="btn btn-themed w-100"><i class="bi bi-magic me-2"></i>Suggest Qty</button>
    </div>
</div>

<!-- Modals -->
<div class="modal fade" id="aiOptimize" tabindex="-1">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content glass-effect border-0">
            <div class="modal-header"><h5 class="modal-title"><i class="bi bi-robot me-2"></i>AI Stock Optimizer</h5><button class="btn-close" data-bs-dismiss="modal"></button></div>
            <div class="modal-body">
                <div class="alert alert-info"><i class="bi bi-lightbulb me-2"></i>Shifting 600 pcs of <strong>Steel Rod 10mm</strong> from WH A ? Site B avoids a stockout in 9 days.</div>
                <ul class="small text-themed-secondary">
                    <li>Reduce safety stock for “C” items by 10%</li>
                    <li>Consolidate PackIt POs to monthly to cut freight by $1.8k/mo</li>
                </ul>
            </div>
            <div class="modal-footer"><button class="btn btn-themed-secondary"><i class="bi bi-truck me-1"></i>Create Transfer</button><button class="btn btn-outline-secondary" data-bs-dismiss="modal">Close</button></div>
        </div>
    </div>
</div>

<div class="modal fade" id="newMaterial" tabindex="-1">
    <div class="modal-dialog modal-md modal-dialog-centered">
        <div class="modal-content glass-effect border-0">
            <div class="modal-header"><h5 class="modal-title"><i class="bi bi-plus-lg me-2"></i>New Material</h5><button class="btn-close" data-bs-dismiss="modal"></button></div>
            <div class="modal-body">
                <div class="mb-3"><label class="form-label">SKU</label><input class="form-control focus-ring"></div>
                <div class="mb-3"><label class="form-label">Name</label><input class="form-control focus-ring"></div>
                <div class="mb-3"><label class="form-label">Supplier</label><input class="form-control focus-ring"></div>
            </div>
            <div class="modal-footer"><button class="btn btn-themed">Create</button></div>
        </div>
    </div>
</div>
